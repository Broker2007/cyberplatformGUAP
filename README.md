# CyberPlatform — опыт pet-проекта

Веб-платформа для студентов и преподавателей по информационной безопасности: студенты решают лабораторные работы в браузере (с заготовкой под встроенный терминал), просматривают каталог заданий; преподаватели работают с демо-страницами групп и заданий. Проект показывает опыт разработки полноценного фронтенда с аутентификацией, каталогом лабораторных, роутингом, темизацией и документированием UI.

---

## Цели проекта

1. **Образовательный продукт** — сделать единую точку входа для практики по ИБ: каталог лабораторных, описание целей и ресурсов, заготовка под консоль/терминал на странице лабораторной.
2. **Разделение ролей** — продемонстрировать сценарии для студентов (лабы, профиль) и преподавателей (группы, задания, админ-зона), в том числе через роуты с проверкой прав.
3. **Продакшен-подход на пет-проекте** — заложить архитектуру, похожую на боевую: RTK Query, переиспользуемые слайсы (entities/features/widgets), защищённые роуты, темизация, Storybook, линтеры, тесты.
4. **Практика стека** — отработать связку React + TypeScript, Redux Toolkit (RTK Query), React Router, кастомная сборка на Webpack 5, удобный локальный цикл разработки и мок API.

---

## Результат проекта

Реализован работающий фронтенд-срез платформы со следующим функционалом.

### Реализовано

- **Лендинг** с позиционированием Red Team / Blue Team, навигацией и адаптацией под залогиненного пользователя (редирект в профиль).
- **Каталог лабораторных работ** (`/labs_templates`): карточки лаб, поиск с дебаунсом (750 ms), пагинация, загрузка данных через RTK Query (`/lab-templates` с `page`, `perPage`, `search`).
- **Страница лабораторной** (`/labs_templates/:id`): описание, цели, ресурсы, заготовка консольного блока под будущий терминал.
- **Демо-страницы для преподавателей**: группы (`/groups`), админ-зона (`/admin`) — статические/демо-данные, готовый UI для последующей интеграции с бэкендом.
- **Аутентификация** на базе RTK Query: регистрация (`/auth/SignUp`), вход (`/auth/SignIn`), выход (`/auth/logout`), обновление токена (`/auth/refresh`), хранение `accessToken` в `localStorage`, запрос текущего пользователя (`/auth/me`).
- **Роутинг и охрана маршрутов**: публичные/приватные страницы, отдельные маршруты только для роли преподавателя (`RequireUser` + `allowedRoles`), лейауты с хедером и без.
- **Темизация** (Blue Team / Red Team) через CSS-переменные и контекст, переключатель темы в интерфейсе.
- **Storybook** для UI-компонентов (Header, Button, FormInput, Input, Loader, PageLoader и др.) и отдельная сборка `storybook-static`.
- **Инфраструктура**: сборка на Webpack 5, Jest + Testing Library, ESLint, Stylelint, поддержка dev-сервера с прокси на API.

### Технологический стек

| Категория   | Технологии |
|------------|------------|
| UI         | React 19, TypeScript |
| Стейт/API  | Redux Toolkit, RTK Query |
| Роутинг    | React Router v7 |
| Стили      | SCSS, CSS-переменные, MUI (частично) |
| Формы      | React Hook Form, Zod, @hookform/resolvers |
| Сборка     | Webpack 5, Babel, ts-loader, sass-loader |
| Качество   | ESLint, Stylelint, Jest, Testing Library |
| Документация UI | Storybook 9 |

---

## Практическая направленность

- **Применение в обучении ИБ** — платформа задумана как практикум: студенты видят список лабораторных, цели, материалы и место для выполнения заданий; интерфейс готов к подключению реального терминала или песочницы.
- **Демонстрация навыков** — проект показывает умение проектировать SPA с разделением на слои (entities, features, widgets, shared), настраивать RTK Query с reauth, делать доступ по ролям и поддерживать удобный цикл разработки (моки, линтеры, тесты, Storybook).
- **Основа для расширения** — структура и API-слой подготовлены к подключению настоящего бэкенда, встраиванию терминала/песочницы и к реализации потоков сдачи отчётов и проверки преподавателями; группы и задания уже представлены в UI и могут быть оживлены при появлении соответствующих эндпоинтов.

---

## Демо

При наличии GIF-демонстрации его можно разместить здесь, например:

```text
![CyberPlatform demo](demo/bandicam%202025-12-19%2010-19-52-123.gif)
```

(Раскомментируйте или обновите путь при добавлении файла в репозиторий.)

---

## Структура репозитория

- **`src/`** — исходный код фронтенда.
  - **`app/`** — провайдеры (Store, Router, Theme, ErrorBoundary), глобальные стили и темы (`themes/blueTeam.scss`, `themes/redTeam.scss`).
  - **`pages/`** — страницы: главная, логин/регистрация, каталог и карточка лабораторных, группы, профиль, админ, 404.
  - **`entities/`** — доменные сущности и API: `labs` (lab-templates), `user` (auth/me).
  - **`features/`** — фичи: `auth` (SignUp/SignIn/logout), `pagination` (слайс, дебаунс, хуки).
  - **`widgets/`** — составные блоки: Header, Sidebar, ErrorPage, SelectionBlock и др.
  - **`shared/`** — общие ресурсы: `api` (baseApi, baseQueryWithReauth), `config` (routeConfig), `layouts`, `ui` (Button, Input, LabItem, Modal, Portal, ThemeSwitcher и др.), `lib` (classNames, useAppDispatch/useAppSelector), `assets`.
- **`config/build/`** — конфигурация Webpack (buildLoaders, buildPlugins, buildResolvers, buildDevServer).
- **`config/jest/`** — конфиг Jest и setup для тестов.
- **`.storybook/`** — конфигурация Storybook.
- **`public/`** — `index.html` и статика.
- **`json-server/`** — мок API (`npm run start:dev:server`), в том числе `db.json` с пользователями и лабораторными.

Собранные артефакты: `build/` (фронт), при наличии — `storybook-static/`.

---

## Локальный запуск (фронтенд)

1. Установите Node.js 18+ и npm.
2. В корне проекта выполните:

```bash
npm install
npm run start
```

Dev-сервер поднимется на порту **3000**. Запросы к API по умолчанию идут на `http://localhost:8080` (см. `src/shared/api/baseQueryWithRefresh.ts`).

Если бэкенд не запущен, можно использовать мок:

```bash
npm run start:dev:server
```

(json-server на порту 8000; при необходимости настройте прокси в `package.json` или в конфиге dev-сервера на 8080/8000.)

### Полезные скрипты

| Команда | Назначение |
|---------|------------|
| `npm run start` | Dev-сервер (порт 3000) |
| `npm run start:dev:server` | Мок API (json-server) |
| `npm run build:dev` / `npm run build:prod` | Сборка в режиме development/production |
| `npm run storybook` | Запуск Storybook (порт 6006) |
| `npm run build-storybook` | Сборка статического Storybook |
| `npm run test:unit` | Юнит-тесты (Jest) |
| `npm run lint:ts` / `npm run lint:ts:fix` | Проверка/автоисправление TypeScript/React (ESLint) |
| `npm run lint:scss` / `npm run lint:scss:fix` | Проверка/автоисправление SCSS (Stylelint) |

---

## Архитектурные заметки

- **RTK Query**: общий `baseApi` и отдельный `authApi`; `baseQueryWithReauth` при 401 делает запрос на `/auth/refresh`, обновляет токен в `localStorage` и повторяет исходный запрос.
- **Ожидаемые эндпоинты бэкенда**: `/auth/SignUp`, `/auth/SignIn`, `/auth/logout`, `/auth/me`, `/auth/refresh`; `/lab-templates` (с параметрами `page`, `perPage`, `search`), `/lab-templates/:id`.
- **Роутинг**: конфиг маршрутов в `shared/config/routeConfig/routeConfig.tsx`; разделение на публичные/приватные и маршруты только для администратора реализовано в `AppRouter` через `RequireUser` и `allowedRoles`.
- **Пагинация и поиск**: состояние в `features/pagination`; при успешном ответе `getLabs` обновляется `totalPages`; поиск с дебаунсом на странице каталога лабораторных.
- **Группы и задания** на соответствующих страницах пока захардкожены и служат основой для последующей интеграции с API.

---

## Ограничения текущей версии

- Бэкенд в этом репозитории не реализован; расчёт на подключение к внешнему API (в т.ч. из закрытого репозитория).
- Данные лабораторных и групп берутся из мока или статики.
- Терминал/песочница и поток сдачи/проверки отчётов пока не подключены и остаются в планах.

---

## Ближайшие шаги (план)

- Подключить реальный бэкенд к RTK Query-слоям.
- Встроить терминал или песочницу (WebSocket/VNC/eve-ng и т.п.) в блок консоли на странице лабораторной.
- Реализовать сдачу и проверку: загрузка отчётов, статусы, комментарии преподавателей.
- Оживить раздел групп: списки групп, участники, назначение и статусы заданий.
- Доработать Dockerfile и CI под dev/stage/prod, вынести настройки в env.

---

## Примечание о приватном репозитории

Полнофункциональная версия может разрабатываться в закрытом репозитории; этот открытый срез используется для предпросмотра UI/UX, демонстрации pet-проекта и синхронизации по требованиям. После согласования API и фичи могут подтягиваться из основной кодовой базы.
